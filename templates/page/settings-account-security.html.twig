{% extends 'base.html.twig' %}

{% block title %}
    Settings - Password
{% endblock %}

{% block stylesheets %}
    <link href="{{ applicationUrl }}/css/settings.css" rel="stylesheet">
{% endblock %}

{% block scripts %}
    <script src="{{ applicationUrl }}/js/qrcode.min.js"></script>
    <script src="{{ applicationUrl }}/js/settings-account-security.js"></script>
{% endblock %}

{% block body %}
    <main role="main" class="container">
        {{ include('component/navbar.html.twig') }}

        <div style="text-align: center;">
            {{ include('component/settings-nav.html.twig') }}

            <div style="padding-top: 1rem">
                <h5>Password change</h5>
                <div class="mb-3">
                    <label for="currentPassword" class="form-label"><b>Current password</b> <span class="text-danger">*</span></label>
                    <input type="password"
                           class="form-control"
                           id="currentPassword"
                           required
                           minlength="10"
                           {% if coreAccountChangesDisabled == true %}disabled{% endif %}
                           style="text-align: center;">
                    <div id="currentPassword" class="form-text">Enter your current password</div>
                </div>

                <div class="mb-3">
                    <label for="newPassword" class="form-label"><b>New password</b> <span class="text-danger">*</span></label>
                    <input type="password"
                           class="form-control"
                           id="newPassword"
                           required
                           minlength="10"
                           {% if coreAccountChangesDisabled == true %}disabled{% endif %}
                           style="text-align: center;">
                    <div class="form-text small">
                        <div class="text-muted mb-1">Password must contain:</div>
                        <div class="text-muted">• At least 10 characters</div>
                        <div class="text-muted">• One uppercase letter</div>
                        <div class="text-muted">• One lowercase letter</div>
                        <div class="text-muted">• One number</div>
                        <div class="text-muted">• One special character</div>
                    </div>
                </div>

                <div class="mb-3">
                    <label for="newPasswordRepeat" class="form-label"><b>Repeat new password</b> <span class="text-danger">*</span></label>
                    <input type="password"
                           class="form-control"
                           id="newPasswordRepeat"
                           required minlength="10"
                           {% if coreAccountChangesDisabled == true %}disabled{% endif %}
                           style="text-align: center;">
                    <div id="newPasswordRepeat" class="form-text">Must match new password</div>
                </div>

                <div id="alertChangePasswordDiv"></div>

                <button class="btn btn-primary"
                        type="button"
                        id="changePasswordUpdateButton"
                        {% if coreAccountChangesDisabled == true %}disabled{% endif %}>
                    Submit
                </button>
            </div>

            <hr>

            <h5 style="margin-bottom: .7rem">Security Settings</h5>
            <div class="alert alert-info" role="alert" style="margin-left: 5%;margin-right: 5%;margin-bottom: 0.7rem!important;margin-top: 1rem">
                <i class="bi bi-info-circle"></i> <strong>Security settings have moved!</strong><br>
                Two-Factor Authentication, Recovery Codes, and Trusted Devices are now available in your <a href="{{ applicationUrl }}/profile" class="alert-link">Profile Settings</a> under the Security tab.
                <div style="margin-top: 1rem">
                    <a href="{{ applicationUrl }}/profile" class="btn btn-sm btn-primary">
                        <i class="bi bi-shield-lock"></i> Go to Profile Security Settings
                    </a>
                </div>
            </div>
        </div>
    </main>
{% endblock %}
