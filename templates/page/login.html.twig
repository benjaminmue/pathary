{% extends 'base.html.twig' %}

{% block title %}
    Login
{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ applicationUrl }}/css/login.css">
{% endblock %}

{% block scripts %}
    <script src="{{ applicationUrl }}/js/login-bg.js"></script>
    <script src="{{ applicationUrl }}/js/login.js"></script>
{% endblock %}

{% block body %}
    <div class="login-container">
        <!-- Centered Logo with Circle Background -->
        <div class="login-logo-wrapper">
            <div class="login-logo-circle">
                <img src="{{ applicationUrl }}/images/pathary-logo-384x384.png"
                     alt="{{ applicationName ?? 'Pathary' }} logo"
                     class="login-logo">
            </div>
        </div>

        <!-- Login Card -->
        <div class="login-card">
            <div id="loginForm">
                <h1 class="text-center">{{ applicationName ?? 'Pathary' }}</h1>

                <div class="form-floating">
                    <input type="email"
                           value="{{ defaultEmail }}"
                           class="form-control"
                           id="email"
                           placeholder="name@example.com"
                           onkeydown="submitCredentialsOnEnter(event)"
                           autocomplete="email"
                           required>
                    <label for="email">Email address</label>
                </div>

                <div class="form-floating">
                    <input type="password"
                           value="{{ defaultPassword }}"
                           class="form-control"
                           id="password"
                           placeholder="Password"
                           onkeydown="submitCredentialsOnEnter(event)"
                           autocomplete="current-password"
                           required>
                    <label for="password">Password</label>
                </div>

                <div class="form-check">
                    <input type="checkbox"
                           class="form-check-input"
                           id="rememberMe"
                           value="true"
                           {{ defaultRememberMe == 'true' ? 'checked' : '' }}>
                    <label class="form-check-label" for="rememberMe">Remember me</label>
                </div>

                <div id="loginErrors"></div>

                {% if redirect != false %}
                    <div class="alert alert-danger" role="alert" id="forbiddenPageAlert">
                        Sign in to access page
                    </div>
                    <input type="hidden" value="{{ redirect }}" name="redirect">
                {% endif %}

                <button class="w-100 btn btn-lg btn-primary mb-3" type="button" onclick="submitCredentials()">
                    Sign in
                </button>

                {% if registrationEnabled == true %}
                    <div class="text-center">
                        <a href="{{ applicationUrl }}/create-user">Create new user</a>
                    </div>
                {% endif %}
            </div>

            <div id="totpForm" class="d-none">
                <h1 class="text-center">Verification</h1>
                <p class="text-center">Enter the 6-digit code from your authenticator app.</p>

                <input type="text"
                       class="form-control form-control-lg text-center mb-3"
                       placeholder="000000"
                       maxlength="6"
                       autocomplete="one-time-code"
                       inputmode="numeric"
                       pattern="[0-9]*"
                       id="totpCode"
                       onkeydown="submitCredentialsOnEnter(event)"
                       required>

                <div id="totpErrors"></div>

                <button class="w-100 btn btn-lg btn-primary mb-3" type="button" onclick="submitCredentials()">
                    Continue
                </button>

                <div class="text-center">
                    <a href="{{ applicationUrl }}/login">Back to login</a>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
